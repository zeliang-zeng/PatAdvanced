this is some pat advanced codes.
I modify it
